# Face_Detection_Recognition


A real time face recognition system is capable of identifying or verifying a person from a video frame. To recognize the face in a frame, first you need to detect whether the face is present in the frame. If it is present, mark it as a region of interest (ROI), extract the ROI and process it for facial recognition.
 
 
# Pre-requisites
1.OpenCV installed :- for that install conda which include all libraries 
  -Conda is an open source package management system and environment management system that runs on Windows, macOS and Linux. Conda quickly     installs, runs and updates packages and their dependencies. 
  -   use Spyder IDE for Python Programming Python 
  
  -install the python from this link :   https://www.python.org/downloads/
  
  -install numpy by typing on commnad promt :- pip install "numpy‑1.14.2+mkl‑cp36‑cp36m‑win32.whl"
  
  -install opencv by typing on commnad promt:- pip install "opencv_python‑3.4.1+contrib‑cp36‑cp36m‑win32.whl'
  -Note the Successfully installed … message after each command. You can safely ignore the upgrade pip suggestion.
  
  after installation check allrequired libraries install or not for that check following in cmd :
  Start the Python interpreter and write:
  
 *import cv2
*print(cv2.__version__)
 
and confirm that you are running the 3.5 (or above) version
If no error messages appear, the OpenCV is correctly installed ON YOUR PYTHON 
OpenCV install, in my case this was 3.4.1.
  
  2.in face recognition reequired image dataset so, go to following link :-
  The sources of images are:
http://www.imageprocessingplace.com/r...
http://sipi.usc.edu/database
# Step 3: Testing Your Camera
* Once you have OpenCV installed in your laptop or  pc  let's test to confirm that your camera is working properly.
 
        import numpy as np
        import cv2

        cap = cv2.VideoCapture(0)
        cap.set(3,640) # set Width
        cap.set(4,480) # set Height
 
    while(True):
    ret, frame = cap.read()
    frame = cv2.flip(frame, -1) # Flip camera vertically if your cam is not flip just comment this line 
    gray = cv2.cvtColor(frame, cv2.COLOR_BGR2GRAY)
    
    cv2.imshow('frame', frame)
    cv2.imshow('gray', gray)
    
    k = cv2.waitKey(30) & 0xff
    if k == 27: # press 'ESC' to quit
        break

       cap.release()
       cv2.destroyAllWindows()
       
*The above code will capture the video stream that will be generated by your webCam, displaying both, in BGR color and Gray mode.
*note:-To finish the program, you must press the key [ESC] on your keyboard

**This project was done with this fantastic "Open Source Computer Vision Library", the OpenCV

# Step 4: Face Detection
...................
Object Detection using Haar feature-based cascade classifiers is an effective object detection method proposed by Paul Viola and Michael Jones in their paper, "Rapid Object Detection using a Boosted Cascade of Simple Features" in 2001. It is a machine learning based approach where a cascade function is trained from a lot of positive and negative images. It is then used to detect objects in other images.

 ................
The most common way to detect a face (or any objects), is using the "Haar Cascade classifier"
OpenCV comes with a trainer as well as detector. If you want to train your own classifier for any object like car, planes etc. you can use OpenCV to create one. Its full details are given here: Cascade Classifier Training.

Here we will deal with detection. OpenCV already contains many pre-trained classifiers for face, eyes, smile etc. Those XML files are stored in opencv/data/haarcascades/ folder. Let's create face and eye detector with OpenCV.

First we need to load the required XML classifiers. Then load our input image (or video) in grayscale mode.
Then, we will set our camera and inside the loop, load our input video in grayscale mode.
  
  
    import numpy as np
    import cv2
    
    face_cascade = cv2.CascadeClassifier('haarcascade_frontalface_default.xml')
    eye_cascade = cv2.CascadeClassifier('haarcascade_eye.xml')
    img = cv2.imread('imageName.jpg')
    gray = cv2.cvtColor(img, cv2.COLOR_BGR2GRAY)
    
  Now we find the faces in the image. If faces are found, it returns the positions of detected faces as Rect(x,y,w,h). Once we get these   locations, we can create a ROI for the face and apply eye detection on this ROI (since eyes are always on the face !!! ).

      faces = face_cascade.detectMultiScale(gray, 1.3, 5)
      for (x,y,w,h) in faces:
      cv2.rectangle(img,(x,y),(x+w,y+h),(255,0,0),2)
       roi_gray = gray[y:y+h, x:x+w]
      roi_color = img[y:y+h, x:x+w]
         eyes = eye_cascade.detectMultiScale(roi_gray)
        for (ex,ey,ew,eh) in eyes:
        cv2.rectangle(roi_color,(ex,ey),(ex+ew,ey+eh),(0,255,0),2)
      cv2.imshow('img',img)
      cv2.waitKey(0)
       cv2.destroyAllWindows()
       
       
   ..........
    Here we will work with face detection. Initially, the algorithm needs a lot of positive images (images of faces) and negative images (images without faces) to train the classifier. Then we need to extract features from it. The good news is that OpenCV comes with a trainer as well as a detector. If you want to train your own classifier for any object like car, planes etc. you can use OpenCV to create one. Its full details are given here:https://docs.opencv.org/3.3.0/dc/d88/tutorial_traincascade.html
    
    ............
    If you do not want to create your own classifier, OpenCV already contains many pre-trained classifiers for face, eyes, smile, etc. Those XML files can be download from haarcascades directory at https://github.com/opencv/opencv/tree/master/data/haarcascades
    
    -When you compare with the last code used to test the camera, you will realize that few parts were added to it. Note the line below:

            faceCascade = cv2.CascadeClassifier('Cascades/haarcascade_frontalface_default.xml')
 
 *This is the line that loads the "classifier" (that must be in a directory named "Cascades/", under your project directory).
 

Now we must call our classifier function, passing it some very important parameters, as scale factor, number of neighbors and minimum size of the detected face. 

     faces = faceCascade.detectMultiScale(
        gray,     
        scaleFactor=1.2,
        minNeighbors=5,     
        minSize=(20, 20)
    )
    
    
 Where,
.gray is the input grayscale image.
.scaleFactor is the parameter specifying how much the image size is reduced at each image scale. It is used to create the scale pyramid.
.minNeighbors is a parameter specifying how many neighbors each candidate rectangle should have, to retain it. A higher number gives           lower false positives.
.minSize is the minimum rectangle size to be considered a face.





The function will detect faces on the image. Next, we must "mark" the faces in the image, using, for example, a blue rectangle. This is done with this portion of the code:

       for (x,y,w,h) in faces:
          cv2.rectangle(img,(x,y),(x+w,y+h),(255,0,0),2)
              roi_gray = gray[y:y+h, x:x+w]
               roi_color = img[y:y+h, x:x+w] 
               
               
               
               
 If faces are found, it returns the positions of detected faces as a rectangle with the left up corner (x,y)
 and having "w" as its Width and "h" as its Height ==> (x,y,w,h). 

Once we get these locations, we can create an "ROI" (drawn rectangle) for the face and present the result with imshow() function.

You can also include classifiers for "eyes detection" or even "smile detection". On those cases, you will include the classifier function and rectangle draw inside the face loop, because would be no sense to detect an eye or a smile outside of a face.

On my GitHub you will find  examples:-
these code you could find in the faceDetectionProject
1.faceEyeDetection.py

2.faceSmileDetection.py

3.faceSmileEyeDetection.py
 
 
 *on my Github you will find the other folder :faceRecognitionProject
 In this folder we would be starting with the training and recognising the image from webcam 

 
 
# To create a complete project on Face Recognition, we must work on 3 very distinct phases:-

     1.Face Detection and Data Gathering
     2.Train the Recognizer
     3.Face Recognition
 



